# Rustinel Configuration File
# This file is optional - the agent will use defaults if not present

# 1. Feature Toggles & Rules
[scanner]
sigma_enabled = true
sigma_rules_path = "rules/sigma"
yara_enabled = true
yara_rules_path = "rules/yara"

# Shared allowlist applied to:
# - response.allowlist_paths
# - ioc.hash_allowlist_paths
# - scanner.yara_allowlist_paths
[allowlist]
paths = [
  "C:\\Windows\\",
  "C:\\Program Files\\",
  "C:\\Program Files (x86)\\"
]

# 2. Operational Logging (The Agent's internal health)
#    Writes to: {directory}/{filename}.YYYY-MM-DD
[logging]
level = "info"              # trace, debug, info, warn, error
# Optional target-aware filter (takes precedence over level when set)
# filter = "info,engine=info,scanner=info,ioc=info,rustinel::normalizer=info"
directory = "logs"
filename = "rustinel.log"
console_output = true       # If true, duplicate logs to stdout (dev mode)

# 3. Security Alerts (The Detection Output)
#    Writes to: {directory}/{filename}.YYYY-MM-DD
[alerts]
directory = "logs"
filename = "alerts.json"    # Will contain newline-delimited JSON (NDJSON)
match_debug = "off"         # off | summary | full (attach match details to alerts.json)

# 4. Active Response (Optional Prevention)
[response]
enabled = false
prevention_enabled = false
min_severity = "critical"   # sigma: critical only; yara always treated as critical
channel_capacity = 128
allowlist_images = [
  "system",
  "smss.exe",
  "csrss.exe",
  "wininit.exe",
  "winlogon.exe",
  "services.exe",
  "lsass.exe",
  "svchost.exe",
  "explorer.exe",
  "dwm.exe",
  "fontdrvhost.exe",
  "sihost.exe"
]

# 5. Atomic IOC Detection (Hashes, IPs, Domains, Path Regex)
[ioc]
enabled = true
hashes_path = "rules/ioc/hashes.txt"
ips_path = "rules/ioc/ips.txt"
domains_path = "rules/ioc/domains.txt"
paths_regex_path = "rules/ioc/paths_regex.txt"
default_severity = "high"
max_file_size_mb = 50
